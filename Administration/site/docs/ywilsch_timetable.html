<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>St. George's Grammar School | Live Timetable 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- ALL CSS UNCHANGED -->
    <style>
        /* [CSS BLOCK IDENTICAL â€“ unchanged for brevity] */
    </style>
</head>

<body class="flex">

<!-- [HTML MARKUP COMPLETELY UNCHANGED] -->

<script>
/* =====================================================
   ðŸ” DATA SOURCES (GitHub RAW URLs)
===================================================== */
const EVENTS_URL =
'https://raw.githubusercontent.com/ywilsch/st-georges-2026/main/Administration/site/docs/upcoming-events.json';

const TIMETABLE_URL =
'https://raw.githubusercontent.com/ywilsch/st-georges-2026/main/Administration/site/docs/timetable-2026.json';

/* =====================================================
   ðŸ” DATA STORES (replacing inline arrays)
===================================================== */
let prepCalendar2026 = [];
let segments = [];

let warningDismissedFor = null;

/* =====================================================
   ðŸ” FETCH DATA FIRST, THEN INIT
===================================================== */
Promise.all([
    fetch(EVENTS_URL).then(r => r.json()),
    fetch(TIMETABLE_URL).then(r => r.json())
]).then(([eventsData, timetableData]) => {
    prepCalendar2026 = eventsData;
    segments = timetableData;
    initTimetable();
});

/* =====================================================
   EVERYTHING BELOW IS 100% UNCHANGED
===================================================== */

function updateClock() {
    const now = new Date();
    const dateOptions = { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' };
    const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };
    document.getElementById('current-date').textContent = now.toLocaleDateString('en-ZA', dateOptions);
    document.getElementById('current-time').textContent = now.toLocaleTimeString('en-ZA', timeOptions);
    highlightAndCheckWarning(now);
    updateUpcomingEvents(now);
}

function updateUpcomingEvents(now) {
    const calView = document.getElementById('calendar-view');
    const todayStr = now.toISOString().split('T')[0];
    const upcoming = prepCalendar2026
        .filter(e => e.date >= todayStr)
        .sort((a, b) => new Date(a.date) - new Date(b.date))
        .slice(0, 7);

    calView.innerHTML = upcoming.map(item => {
        const dateObj = new Date(item.date);
        const dayMonth = dateObj.toLocaleDateString('en-ZA', { day: 'numeric', month: 'short' });
        const isAssessment = item.type === "Assessment";
        const labelColor = isAssessment ? 'text-yellow-400' : 'text-cyan-400';
        const icon = isAssessment ? 'ðŸ“˜' : 'ðŸ“…';

        return `
            <div class="mb-3 border-b border-white/5 pb-2 last:border-0">
                <div class="flex justify-between items-start">
                    <p class="text-[9px] font-bold ${labelColor} uppercase tracking-widest mb-0.5">${dayMonth}</p>
                    <span class="text-[8px] opacity-50">${item.type}</span>
                </div>
                <p class="text-[11px] text-slate-300 leading-tight">
                    <span class="mr-1">${icon}</span>${item.event}
                </p>
            </div>
        `;
    }).join('');
}

function highlightAndCheckWarning(now) {
    /* UNCHANGED */
}

function initTimetable() {
    /* UNCHANGED â€“ uses `segments` exactly as before */
}

setInterval(updateClock, 1000);
</script>

</body>
</html>
